{"version":3,"file":"footer-popover.min.js","sources":["../src/footer-popover.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Shows the footer content in a popover.\r\n *\r\n * @module     theme_boost/footer-popover\r\n * @copyright  2021 Bas Brands\r\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nimport $ from 'jquery';\r\nimport Popover from './popover';\r\n\r\nconst SELECTORS = {\r\n    FOOTERCONTAINER: '[data-region=\"footer-container-popover\"]',\r\n    FOOTERCONTENT: '[data-region=\"footer-content-popover\"]',\r\n    FOOTERBUTTON: '[data-action=\"footer-popover\"]'\r\n};\r\n\r\nlet footerIsShown = false;\r\n\r\nexport const init = () => {\r\n    const container = document.querySelector(SELECTORS.FOOTERCONTAINER);\r\n    const footerButton = document.querySelector(SELECTORS.FOOTERBUTTON);\r\n\r\n    // All jQuery in this code can be replaced when MDL-71979 is integrated.\r\n    $(footerButton).popover({\r\n        content: getFooterContent,\r\n        container: container,\r\n        html: true,\r\n        placement: 'top',\r\n        customClass: 'footer',\r\n        trigger: 'click',\r\n        boundary: 'viewport',\r\n        popperConfig: {\r\n            modifiers: {\r\n                preventOverflow: {\r\n                    boundariesElement: 'viewport',\r\n                    padding: 48\r\n                },\r\n                offset: {},\r\n                flip: {\r\n                    behavior: 'flip'\r\n                },\r\n                arrow: {\r\n                    element: '.arrow'\r\n                },\r\n            }\r\n        }\r\n    });\r\n\r\n    document.addEventListener('click', e => {\r\n        if (footerIsShown && !e.target.closest(SELECTORS.FOOTERCONTAINER)) {\r\n            $(footerButton).popover('hide');\r\n        }\r\n    },\r\n    true);\r\n\r\n    document.addEventListener('keydown', e => {\r\n        if (footerIsShown && e.key === 'Escape') {\r\n            $(footerButton).popover('hide');\r\n            footerButton.focus();\r\n        }\r\n    });\r\n\r\n    document.addEventListener('focus', e => {\r\n        if (footerIsShown && !e.target.closest(SELECTORS.FOOTERCONTAINER)) {\r\n            $(footerButton).popover('hide');\r\n        }\r\n    },\r\n    true);\r\n\r\n    $(footerButton).on('show.bs.popover', () => {\r\n        footerIsShown = true;\r\n    });\r\n\r\n    $(footerButton).on('hide.bs.popover', () => {\r\n        footerIsShown = false;\r\n    });\r\n};\r\n\r\n/**\r\n * Get the footer content for popover.\r\n *\r\n * @returns {String} HTML string\r\n * @private\r\n */\r\nconst getFooterContent = () => {\r\n    return document.querySelector(SELECTORS.FOOTERCONTENT).innerHTML;\r\n};\r\n\r\nexport {\r\n    Popover\r\n};\r\n"],"names":["_interopRequireDefault","e","__esModule","default","_jquery","_popover","SELECTORS","footerIsShown","_exports","init","container","document","querySelector","footerButton","$","popover","content","getFooterContent","html","placement","customClass","trigger","boundary","popperConfig","modifiers","preventOverflow","boundariesElement","padding","offset","flip","behavior","arrow","element","addEventListener","target","closest","key","focus","on","innerHTML"],"mappings":"0GAwBgC,SAAAA,uBAAAC,GAAAA,OAAAA,GAAAA,EAAAC,WAAAD,EAAAE,CAAAA,QAAAF,EAAA;;;;;;;oLADhCG,QAAAJ,uBAAAI,SACAC,SAAAL,uBAAAK,UAEA,MAAMC,0BACe,2CADfA,wBAEa,yCAFbA,uBAGY,iCAGlB,IAAIC,eAAgB,EA4DlBC,SAAAC,KA1DkBA,KAChB,MAAMC,UAAYC,SAASC,cAAcN,2BACnCO,aAAeF,SAASC,cAAcN,yBAG5C,EAAAQ,iBAAED,cAAcE,QAAQ,CACpBC,QAASC,iBACTP,UAAWA,UACXQ,MAAM,EACNC,UAAW,MACXC,YAAa,SACbC,QAAS,QACTC,SAAU,WACVC,aAAc,CACVC,UAAW,CACPC,gBAAiB,CACbC,kBAAmB,WACnBC,QAAS,IAEbC,OAAQ,CAAE,EACVC,KAAM,CACFC,SAAU,QAEdC,MAAO,CACHC,QAAS,cAMzBrB,SAASsB,iBAAiB,SAAShC,IAC3BM,gBAAkBN,EAAEiC,OAAOC,QAAQ7B,6BACnC,EAAAQ,QAAAA,SAAED,cAAcE,QAAQ,OAC5B,IAEJ,GAEAJ,SAASsB,iBAAiB,WAAWhC,IAC7BM,eAA2B,WAAVN,EAAEmC,OACnB,EAAAtB,QAAAA,SAAED,cAAcE,QAAQ,QACxBF,aAAawB,QACjB,IAGJ1B,SAASsB,iBAAiB,SAAShC,IAC3BM,gBAAkBN,EAAEiC,OAAOC,QAAQ7B,6BACnC,EAAAQ,QAAAA,SAAED,cAAcE,QAAQ,OAC5B,IAEJ,IAEA,EAAAD,QAAAA,SAAED,cAAcyB,GAAG,mBAAmB,KAClC/B,eAAgB,CAAI,KAGxB,EAAAO,QAAAA,SAAED,cAAcyB,GAAG,mBAAmB,KAClC/B,eAAgB,CAAK,GACvB,EASN,MAAMU,iBAAmBA,IACdN,SAASC,cAAcN,yBAAyBiC,SACzD"}